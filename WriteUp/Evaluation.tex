\documentclass[12pt]{article}
\usepackage{amssymb,amsmath,latexsym, verbatim}
\usepackage{tikz,listings,url}
\usepackage{mathtools}
\usepackage{float}
\usepackage[margin=0.5in]{geometry}
%\usepackage{hyperref}
\usetikzlibrary{matrix,shapes,arrows,positioning,chains, calc}

\lstset{basicstyle=\bfseries\small}

\newcommand{\nbar}{\overline{n}}
\newcommand{\mbar}{\overline{m}}

\begin{document}
\title{Evaluation of LWE Key Exchange Protocol}
\maketitle

\section{Assymptotics}
\begin{center}
    \begin{tabular}{| l | l |}
    \hline
Server work & $O(n^2\nbar)$\\ \hline
Client work & $O(n^2\mbar)$\\ \hline
Client downloads & $O(n \nbar)$\\ \hline
Client uploads & $O(n \mbar)$\\ \hline
    \end{tabular}
\end{center}

\section{First round of evaluations}
\subsection{RLWE \tiny{(RLWE-RSA-AES128-GCM-SHA256)}}

\footnotesize{\textbf{keygen:} sampling $s(')$, $e(')$ and computing $b(') = as(') + e(')$\\
\textbf{Bob shared:} sampling $e''$, computing $v = s'b + e''$, $c = \langle v \rangle_2$, $k = \lfloor v \rceil_2$\\
\textbf{Alice shared:} computing $k = rec(b's, c)$}\\

RLWE (128 bits security, deriving 1024 bits key)
\begin{center}
    \begin{tabular}{| l | l | l |}
    \hline
    keygen & Bob shared & Alice shared \\ \hline
    0.674ms & 0.402ms & 0.119ms  \\ \hline
    \end{tabular}
\end{center}

TSH protocol transcript:
\begin{center}
    \begin{tabular}{| l | l | l |}
    \hline
    $\leftarrow$ ClientHello & 94B & 0x005e\\ \hline
    $\rightarrow$ ServerHello & 58B & 0x003a\\ \hline
    $\rightarrow$ Certificate & 594B & 0x0252\\ \hline
    \textcolor{red}{$\rightarrow$ ServerKeyExchange} & \textcolor{red}{4234B = 4KiB} & 0x108a\\ \hline
    $\rightarrow$ ServerHelloDone & 4B & 0x4\\ \hline
    \textcolor{red}{$\leftarrow$ ClientKeyExchange} & \textcolor{red}{4232B = 4KiB} & 0x1088\\ \hline
    $\leftarrow$ ChangeCipherSpec & 1B & 0x1\\ \hline
    $\leftarrow$ Finished & 16B & 0x10\\ \hline
    $\rightarrow$ Session Ticket & 170B & 0x00aa\\ \hline
    $\rightarrow$ ChangeCipherSpec & 1B & 0x1\\ \hline
    $\rightarrow$ Finished & 16B & 0x10\\ \hline
    \end{tabular}
\end{center}

\subsection{LWE \tiny{(LWE-RSA-AES128-GCM-SHA256)}}

\footnotesize{\textbf{Alice keygen:} sampling $S$, $E$ and computing $B = AS + E$\\
\textbf{Bob keygen:} sampling $S'$, $E'$ and computing $B' = S'A + E'$\\
\textbf{Bob shared:} sampling $E''$, computing $V = S'B + E''$, $C = \langle V \rangle_2$, $K = \lfloor V \rceil_2$\\
\textbf{Alice shared:} computing $K = rec(B'S, C)$\\}

LWE (128 bits security, deriving $128 = \nbar \mbar$ bits key)
\begin{center}
    \begin{tabular}{| l | l | l | l |}
    \hline
    Alice keygen & Bob keygen & Bob shared & Alice shared \\ \hline
    15.7ms & 29.5ms & 0.2ms & 0.1ms \\ \hline
    \multicolumn{4}{c}{Using $A^T$ in generating client's key:} \\ \hline
    15.9s &   \textcolor{red}{14.9ms} &   0.147ms &   0.119ms \\ \hline
    \end{tabular}
\end{center}
About 20 X slowdown in key generation compared to RLWE, the rest is comparable.

TSH protocol transcript:
\begin{center}
    \begin{tabular}{| l | l | l |}
    \hline
    $\leftarrow$ ClientHello & 94B & 0x005e\\ \hline
    $\rightarrow$ ServerHello & 58B & 0x003a\\ \hline
    $\rightarrow$ Certificate & 594B & 0x0252\\ \hline
    \textcolor{red}{$\rightarrow$ ServerKeyExchange} & \textcolor{red}{49290B = 48KiB} & 0xc08a\\ \hline
    $\rightarrow$ ServerHelloDone & 4B & 0x4\\ \hline
    \textcolor{red}{$\leftarrow$ ClientKeyExchange} & \textcolor{red}{49176B = 48KiB} & 0xc018\\ \hline
    $\leftarrow$ ChangeCipherSpec & 1B & 0x1\\ \hline
    $\leftarrow$ Finished & 16B & 0x10\\ \hline
    $\rightarrow$ Session Ticket & 170B & 0x00aa\\ \hline
    $\rightarrow$ ChangeCipherSpec & 1B & 0x1\\ \hline
    $\rightarrow$ Finished & 16B & 0x10\\ \hline
    \end{tabular}
\end{center}
\end{document}
